# å…¥å£å’Œå‡ºå£

## å…¥å£

å…¥å£é€šè¿‡[entry](https://www.webpackjs.com/configuration/entry-context/#entry)å­—æ®µæ¥é…ç½®ï¼Œ**å…¥å£çœŸæ­£é…ç½®çš„æ˜¯chunk**ï¼Œä¸€ä¸ªkeyå°±è¡¨ç¤ºä¸€ä¸ªchunkã€‚

```js
module.exports = {
    entry: {
        // keyå€¼å°†ä½œä¸ºchunkçš„åç§°ï¼Œvalueå€¼ä½œä¸ºå…¥å£æ¨¡å—çš„è·¯å¾„
        main: './src/index.js', // é»˜è®¤æƒ…å†µ
        a: './src/a.js',
        bc: ['./src/b.js', './src/c.js'] // ä¼šæŒ‰é¡ºåºæ‰§è¡Œæ¯ä¸€é¡¹ï¼Œå¹¶å°†å®ƒä»¬åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶
    }
}
```

## å‡ºå£

å‡ºå£é€šè¿‡[output](https://www.webpackjs.com/configuration/output/)å­—æ®µæ¥é…ç½®ï¼Œä¸»è¦é’ˆå¯¹èµ„æºåˆ—è¡¨çš„æ–‡ä»¶åå’Œæ–‡ä»¶è·¯å¾„è¿›è¡Œé…ç½®ã€‚å¸¸ç”¨é…ç½®å¦‚ä¸‹ï¼š

### `ouptut.path`

pathå¿…é¡»é…ç½®ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œè¡¨ç¤ºbundleè¾“å‡ºçš„ä½ç½®ã€‚

### `output.filename`

filenameå†³å®šäº†æ¯ä¸ªè¾“å‡ºbundleçš„åç§°ã€‚è¿™äº› bundle å°†å†™å…¥åˆ°`output.path`é€‰é¡¹æŒ‡å®šçš„ç›®å½•ä¸‹ã€‚

å¯¹äºå•ä¸ªå…¥å£èµ·ç‚¹ï¼Œfilename ä¼šæ˜¯ä¸€ä¸ªé™æ€åç§°ã€‚

```js
filename: 'js/bundle.js' // è¡¨ç¤ºè¾“å‡ºåˆ°${ouput.path}/js/bundle.js
```

ç„¶è€Œï¼Œå½“é€šè¿‡å¤šä¸ªå…¥å£èµ·ç‚¹(entry point)ã€ä»£ç æ‹†åˆ†(code splitting)æˆ–å„ç§æ’ä»¶(plugin)åˆ›å»ºå¤šä¸ª bundleï¼Œåº”è¯¥ä½¿ç”¨ä»¥ä¸‹ä¸€ç§æ›¿æ¢æ–¹å¼ï¼Œæ¥èµ‹äºˆæ¯ä¸ª bundle ä¸€ä¸ªå”¯ä¸€çš„åç§°ã€‚

**ä½¿ç”¨å†…éƒ¨ chunk idï¼š**

ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºidåœ¨å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä¸­ä¸åŒ

```js
filename: '[id].bundle.js'
```

**ä½¿ç”¨chunkåç§° + æ€»hashçš„å‰äº”ä½å‘½åï¼š**

```js
filename: '[name].[hash:5].bundle.js'
```

**ä½¿ç”¨chunkåç§° + chunkhashï¼š**

ä½¿ç”¨chunkhashçš„å¥½å¤„æ˜¯ï¼Œåªæ”¹åŠ¨ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¸ä¼šå¯¼è‡´å…¶ä»–æ–‡ä»¶å†æ¬¡æ‰“åŒ…ã€‚

```js
filename: '[name].[chunkhash:5].bundle.js'
```
ouputçš„å®Œæ•´é…ç½®å¦‚ä¸‹ï¼š

```js
const path = require('path');

module.exports = {
    output: {
        path: path.resolve(__dirname, './dist'), // é»˜è®¤æƒ…å†µ
        filename: '[name].[chunkhash:5].bundle.js'
    }
}
```

## æœ€ä½³å®è·µ

ä¸‹é¢æ˜¯ä¸€äº›ç»å…¸åœºæ™¯ï¼š

### ä¸€ä¸ªé¡µé¢ä¸€ä¸ªJS

<img src="https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220706162753362.png" alt="image-20220706162753362"  />

ç›®å½•ç»“æ„ï¼š

:::vue

|â€”â€” src
|   |â€”â€” pageA   é¡µé¢Açš„ä»£ç ç›®å½•
|        |â€”â€” index.js é¡µé¢Açš„å¯åŠ¨æ¨¡å—
|        |â€”â€” ...
|    |â€”â€” pageB   é¡µé¢Bçš„ä»£ç ç›®å½•
|        |â€”â€” index.js é¡µé¢Bçš„å¯åŠ¨æ¨¡å—
|        |â€”â€” ...
|    |â€”â€” pageC   é¡µé¢Cçš„ä»£ç ç›®å½•
|        |â€”â€” main1.js é¡µé¢Cçš„å¯åŠ¨æ¨¡å—1 ä¾‹å¦‚ï¼šä¸»åŠŸèƒ½
|        |â€”â€” main2.js é¡µé¢Cçš„å¯åŠ¨æ¨¡å—2 ä¾‹å¦‚ï¼šå®ç°è®¿é—®ç»Ÿè®¡çš„é¢å¤–åŠŸèƒ½
|        |â€”â€” ...
|    |â€”â€” common  å…¬å…±ä»£ç ç›®å½•
|        |â€”â€” ...

:::

webpacké…ç½®ï¼š

```js
module.exports = {
    entry:{
        pageA: "./src/pageA/index.js",
        pageB: "./src/pageB/index.js",
        pageC: ["./src/pageC/main1.js", "./src/pageC/main2.js"]
    },
    output:{
        filename:"[name].[chunkhash:5].js"
    }
}
```

è¿™ç§æ–¹å¼é€‚ç”¨äºé¡µé¢ä¹‹é—´çš„åŠŸèƒ½å·®å¼‚å·¨å¤§ã€å…¬å…±ä»£ç è¾ƒå°‘çš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µä¸‹æ‰“åŒ…å‡ºæ¥çš„æœ€ç»ˆä»£ç ä¸ä¼šæœ‰å¤ªå¤šé‡å¤ã€‚

ä½†æ˜¯å¦‚æœå…¬å…±ä»£ç è¿‡å¤šï¼Œä¼šå¯¼è‡´é¡¹ç›®çš„æ‰“åŒ…æ–‡ä»¶ä½“ç§¯è¿‡å¤§ã€‚

ä¸¾ä¸ªğŸŒ°ï¼špageAæ–‡ä»¶10kbï¼Œcommonæ–‡ä»¶5kbï¼ŒpageAæ–‡ä»¶ä¾èµ–äºcommonæ–‡ä»¶ï¼Œé‚£ä¹ˆpageAæ–‡ä»¶æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„ä½“ç§¯å°±æ˜¯10 + 5 = 15kbã€‚

å¦‚æœæœ‰å¤§é‡çš„é¡µé¢æ–‡ä»¶ä¾èµ–äºcommonæ–‡ä»¶ï¼Œå¯ä»¥çœ‹å‡ºæœ€åæ‰“åŒ…å‡ºæ¥çš„æ¯ä¸ªæ–‡ä»¶ä¸­éƒ½æœ‰å¤§é‡ç›¸åŒçš„ä»£ç ï¼Œå¹¶ä¸”é¡¹ç›®çš„æ„å»ºåŒ…ä½“ç§¯å·¨å¤§ã€‚

**é‚£ä¸ºä»€ä¹ˆä¸æŠŠå…¬å…±ä»£ç å•ç‹¬æŠ½ç¦»æˆä¸€ä¸ªchunkå‘¢ï¼Ÿ**

ä¸å¯è¡Œï¼Œå› ä¸ºæœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä¸å†å…·æœ‰ä¾èµ–å…³ç³»ï¼Œè¿™æ ·çš„è¯ï¼Œæ‰“åŒ…å‡ºæ¥çš„pageAæ–‡ä»¶å°±æ— æ³•ä½¿ç”¨å…¬å…±ä»£ç äº†ã€‚



### ä¸€ä¸ªé¡µé¢å¤šä¸ªJS

<img src="https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220706163350552.png" alt="image-20220706163350552"  />

ç›®å½•ç»“æ„ï¼š

:::vue

|â€”â€” src
|    |â€”â€” pageA   é¡µé¢Açš„ä»£ç ç›®å½•
|        |â€”â€” index.js é¡µé¢Açš„å¯åŠ¨æ¨¡å—
|        |â€”â€” ...
|    |â€”â€” pageB   é¡µé¢Bçš„ä»£ç ç›®å½•
|        |â€”â€” index.js é¡µé¢Bçš„å¯åŠ¨æ¨¡å—
|        |â€”â€” ...
|    |â€”â€” statistics   ç”¨äºç»Ÿè®¡è®¿é—®äººæ•°åŠŸèƒ½ç›®å½•
|        |â€”â€” index.js å¯åŠ¨æ¨¡å—
|        |â€”â€” ...
|    |â€”â€” common  å…¬å…±ä»£ç ç›®å½•
|        |â€”â€” ...

:::

webpacké…ç½®ï¼š

```js
module.exports = {
    entry:{
        pageA: "./src/pageA/index.js",
        pageB: "./src/pageB/index.js",
        statistics: "./src/statistics/index.js"
    },
    output:{
        filename:"[name].[chunkhash:5].js"
    }
}
```

è¿™ç§æ–¹å¼é€‚ç”¨äºé¡µé¢ä¹‹é—´æœ‰ä¸€äº›**ç‹¬ç«‹**ã€ç›¸åŒçš„åŠŸèƒ½ï¼Œä¸“é—¨ä½¿ç”¨ä¸€ä¸ªchunkæŠ½ç¦»è¿™éƒ¨åˆ†JSï¼Œæœ‰åˆ©äºæµè§ˆå™¨æ›´å¥½çš„ç¼“å­˜è¿™éƒ¨åˆ†å†…å®¹ã€‚

**ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¤šæ¨¡å—å…¥å£èµ·ç‚¹ï¼Ÿ**

```js
module.exports = {
    entry:{
        pageA: ["./src/statistics/index.js", "./src/pageA/index.js"],
        pageB: ["./src/statistics/index.js", "./src/pageB/index.js"],
    },
    output:{
        filename:"[name].[chunkhash:5].js"
    }
}
```

é¦–å…ˆè¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºå¤šæ¨¡å—å…¥å£èµ·ç‚¹æœ€ç»ˆä¼šå°†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹éƒ½æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œè®©å…¬å…±ä»£ç ä¸å…¶ä»–æ–‡ä»¶åˆå¹¶åˆ°ä¸€èµ·ï¼Œä½¿å¾—è¿™äº›å…¬å…±ä»£ç éš¾ä»¥å¾—åˆ°ç¼“å­˜ã€‚åŒæ—¶å½“å…¬å…±ä»£ç é‡å¢åŠ æ—¶ï¼Œä¹Ÿä¼šä½¿å¾—é¡¹ç›®æ‰“åŒ…ä½“ç§¯å‰§å¢ã€‚

### å•é¡µé¢åº”ç”¨

æ‰€è°“å•é¡µåº”ç”¨ï¼Œæ˜¯æŒ‡æ•´ä¸ªç½‘ç«™ï¼ˆæˆ–ç½‘ç«™çš„æŸä¸€ä¸ªåŠŸèƒ½å—ï¼‰åªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œé¡µé¢ä¸­çš„å†…å®¹å…¨éƒ¨é JSåˆ›å»ºå’Œæ§åˆ¶ã€‚ vueå’Œreactéƒ½æ˜¯å®ç°å•é¡µåº”ç”¨çš„åˆ©å™¨ã€‚

<img src="https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220706163647336.png" alt="image-20220706163647336"  />

ç›®å½•ç»“æ„ï¼š

:::vue

|â€”â€” src
|    |â€”â€” subFunc1   å­åŠŸèƒ½ç›®å½•
|        |â€”â€” ...
|    |â€”â€” subFunc2  å­åŠŸèƒ½ç›®å½•
|        |â€”â€” ...
|    |â€”â€” common  å…¬å…±ä»£ç ç›®å½•
|        |â€”â€” ...
|    |â€”â€” index.js

:::

webpacké…ç½®

```js
module.exports = {
    entry: "./src/index.js",
    output:{
        filename:"index.[hash:5].js"
    }
}
```

<Vssue 
    :options="{ labels: [$page.relativePath.split('/')[0]] }" 
    :title="$page.relativePath.split('/')[1]" 
/>
